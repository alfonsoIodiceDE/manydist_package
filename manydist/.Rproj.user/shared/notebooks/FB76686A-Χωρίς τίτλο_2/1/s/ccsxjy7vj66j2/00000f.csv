"0","cat(""\n=== CYCLE-SPECIFIC CLUSTERING QUALITY ASSESSMENT ===\n"")"
"1","
=== CYCLE-SPECIFIC CLUSTERING QUALITY ASSESSMENT ===
"
"0","evaluate_cycle_clustering_quality <- function(cycle_clustering_results, cycle_distances, cycle_name) {"
"0","  "
"0","  cat(sprintf(""\n→ Evaluating clustering quality for PISA %s...\n"", cycle_name))"
"0","  "
"0","  cycle_evaluations <- list()"
"0","  "
"0","  for (dist_method in names(cycle_clustering_results)) {"
"0","    if (!is.null(cycle_distances[[dist_method]])) {"
"0","      "
"0","      dist_matrix <- cycle_distances[[dist_method]]$matrix"
"0","      "
"0","      # Evaluate macro clustering"
"0","      macro_eval <- evaluate_all_clusterings("
"0","        cycle_clustering_results[[dist_method]]$macro,"
"0","        dist_matrix,"
"0","        ""macro"""
"0","      )"
"0","      "
"0","      # Evaluate micro clustering"
"0","      micro_eval <- evaluate_all_clusterings("
"0","        cycle_clustering_results[[dist_method]]$micro,"
"0","        dist_matrix,"
"0","        ""micro"""
"0","      )"
"0","      "
"0","      cycle_evaluations[[dist_method]] <- list("
"0","        macro = macro_eval,"
"0","        micro = micro_eval"
"0","      )"
"0","    }"
"0","  }"
"0","  "
"0","  return(cycle_evaluations)"
"0","}"
"0",""
"0","# Evaluate clustering quality for all cycles"
"0","all_cycle_evaluations <- list()"
"0",""
"0","for (cycle_name in names(all_cycle_clustering_results)) {"
"0","  all_cycle_evaluations[[cycle_name]] <- evaluate_cycle_clustering_quality("
"0","    all_cycle_clustering_results[[cycle_name]],"
"0","    all_cycle_distances[[cycle_name]],"
"0","    cycle_name"
"0","  )"
"0","}"
"1","
→ Evaluating clustering quality for PISA 2015...
"
"1","
→ Evaluating clustering quality for PISA 2018...
"
"1","
→ Evaluating clustering quality for PISA 2022...
"
"0","cat(""\n✓ Quality assessment completed for all cycles\n"")"
"1","
✓ Quality assessment completed for all cycles
"
