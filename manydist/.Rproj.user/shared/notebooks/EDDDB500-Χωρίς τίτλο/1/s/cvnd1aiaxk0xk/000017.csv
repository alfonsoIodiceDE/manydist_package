"0",""
"0","# 3. Distance method comparison"
"0","distance_comparison_plot <- function(calibrated_df, clustering_type) {"
"0","  "
"0","  # Aggregate by distance method"
"0","  distance_summary <- calibrated_df %>%"
"0","    group_by(distance_method, k) %>%"
"0","    summarise("
"0","      mean_composite = mean(composite_index),"
"0","      max_composite = max(composite_index),"
"0","      .groups = ""drop"""
"0","    )"
"0","  "
"0","  p <- ggplot(distance_summary, aes(x = k)) +"
"0","    geom_line(aes(y = mean_composite, color = distance_method), "
"0","              linewidth = 1, alpha = 0.7) +"
"0","    geom_line(aes(y = max_composite, color = distance_method), "
"0","              linewidth = 1, linetype = ""dashed"") +"
"0","    scale_color_viridis_d(name = ""Distance Method"") +"
"0","    labs(title = paste(""Distance Method Performance Comparison -"", "
"0","                       tools::toTitleCase(clustering_type), ""Level""),"
"0","         subtitle = ""Solid line = mean score, Dashed line = best score"","
"0","         x = ""Number of Clusters (K)"","
"0","         y = ""Composite Index Score"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""bottom"","
"0","          plot.title = element_text(size = 14, face = ""bold""))"
"0","  "
"0","  return(p)"
"0","}"
"0",""
"0","distance_macro_plot <- distance_comparison_plot(calibrated_macro, ""macro"")"
"0","distance_micro_plot <- distance_comparison_plot(calibrated_micro, ""micro"")"
"0",""
"0","print(distance_macro_plot)"
