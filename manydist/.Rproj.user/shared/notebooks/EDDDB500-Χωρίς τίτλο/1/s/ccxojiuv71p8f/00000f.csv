"0","cat(""\\n=== ASSESSING CLUSTERING QUALITY ===\\n"")"
"1","\n=== ASSESSING CLUSTERING QUALITY ===\n"
"0","# Function to evaluate all clusterings for a given distance method"
"0","evaluate_all_clusterings <- function(clustering_results, distance_matrix, "
"0","                                     clustering_type = ""macro"") {"
"0","  "
"0","  cat(sprintf(""→ Evaluating %s clusterings...\\n"", clustering_type))"
"0","  "
"0","  evaluation_results <- list()"
"0","  "
"0","  for (method_name in names(clustering_results)) {"
"0","    cat(sprintf(""  → Evaluating %s method...\\n"", method_name))"
"0","    "
"0","    method_evaluations <- list()"
"0","    "
"0","    method_results <- clustering_results[[method_name]]"
"0","    "
"0","    for (k_name in names(method_results)) {"
"0","      if (!is.null(method_results[[k_name]])) {"
"0","        "
"0","        cluster_result <- method_results[[k_name]]"
"0","        k <- cluster_result$k"
"0","        labels <- cluster_result$labels"
"0","        "
"0","        # Evaluate clustering quality"
"0","        quality_metrics <- evaluate_clustering_quality("
"0","          distance_matrix, labels, method_name, k, "
"0","          detailed = (clustering_type == ""macro"")  # More detailed for macro"
"0","        )"
"0","        "
"0","        # Store results"
"0","        method_evaluations[[k_name]] <- list("
"0","          k = k,"
"0","          method = method_name,"
"0","          quality = quality_metrics,"
"0","          labels = labels"
"0","        )"
"0","      }"
"0","    }"
"0","    "
"0","    evaluation_results[[method_name]] <- method_evaluations"
"0","    cat(sprintf(""  ✓ %s evaluation completed\\n"", method_name))"
"0","  }"
"0","  "
"0","  return(evaluation_results)"
"0","}"
"0",""
"0","# Evaluate clustering quality for all distance methods"
"0","clustering_evaluations <- list()"
"0",""
"0","for (dist_method in names(all_clustering_results)) {"
"0","  "
"0","  cat(sprintf(""\\n--- Evaluating %s Distance Method ---\\n"", dist_method))"
"0","  "
"0","  dist_matrix <- all_clustering_results[[dist_method]]$distance_info$matrix"
"0","  "
"0","  # Evaluate macro clustering"
"0","  macro_evaluations <- evaluate_all_clusterings("
"0","    all_clustering_results[[dist_method]]$macro, "
"0","    dist_matrix, "
"0","    ""macro"""
"0","  )"
"0","  "
"0","  # Evaluate micro clustering  "
"0","  micro_evaluations <- evaluate_all_clusterings("
"0","    all_clustering_results[[dist_method]]$micro,"
"0","    dist_matrix,"
"0","    ""micro"""
"0","  )"
"0","  "
"0","  clustering_evaluations[[dist_method]] <- list("
"0","    macro = macro_evaluations,"
"0","    micro = micro_evaluations"
"0","  )"
"0","}"
"1","\n--- Evaluating unbiased_independent Distance Method ---\n"
"1","→ Evaluating macro clusterings...\n"
"1","  → Evaluating pam method...\n"
"1","  ✓ pam evaluation completed\n"
"1","  → Evaluating ward method...\n"
"1","  ✓ ward evaluation completed\n"
"1","  → Evaluating average_linkage method...\n"
"1","  ✓ average_linkage evaluation completed\n"
"1","  → Evaluating complete_linkage method...\n"
"1","  ✓ complete_linkage evaluation completed\n"
"1","  → Evaluating single_linkage method...\n"
"1","  ✓ single_linkage evaluation completed\n"
"1","→ Evaluating micro clusterings...\n"
"1","  → Evaluating pam method...\n"
"1","  ✓ pam evaluation completed\n"
"1","  → Evaluating ward method...\n"
"1","  ✓ ward evaluation completed\n"
"1","  → Evaluating average_linkage method...\n"
"1","  ✓ average_linkage evaluation completed\n"
"1","  → Evaluating complete_linkage method...\n"
"1","  ✓ complete_linkage evaluation completed\n"
"1","  → Evaluating single_linkage method...\n"
"1","  ✓ single_linkage evaluation completed\n"
"1","\n--- Evaluating unbiased_dependent Distance Method ---\n"
"1","→ Evaluating macro clusterings...\n"
"1","  → Evaluating pam method...\n"
"1","  ✓ pam evaluation completed\n"
"1","  → Evaluating ward method...\n"
"1","  ✓ ward evaluation completed\n"
"1","  → Evaluating average_linkage method...\n"
"1","  ✓ average_linkage evaluation completed\n"
"1","  → Evaluating complete_linkage method...\n"
"1","  ✓ complete_linkage evaluation completed\n"
"1","  → Evaluating single_linkage method...\n"
"1","  ✓ single_linkage evaluation completed\n"
"1","→ Evaluating micro clusterings...\n"
"1","  → Evaluating pam method...\n"
"1","  ✓ pam evaluation completed\n"
"1","  → Evaluating ward method...\n"
"1","  ✓ ward evaluation completed\n"
"1","  → Evaluating average_linkage method...\n"
"1","  ✓ average_linkage evaluation completed\n"
"1","  → Evaluating complete_linkage method...\n"
"1","  ✓ complete_linkage evaluation completed\n"
"1","  → Evaluating single_linkage method...\n"
"1","  ✓ single_linkage evaluation completed\n"
"0","cat(""\\n✓ Clustering quality assessment completed\\n"")"
"1","\n✓ Clustering quality assessment completed\n"
