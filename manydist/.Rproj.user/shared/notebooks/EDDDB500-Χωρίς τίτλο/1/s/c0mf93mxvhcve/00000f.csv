"0","cat(""\\n=== IMPLEMENTING CLUSTERING ALGORITHMS ===\\n"")"
"1","\n=== IMPLEMENTING CLUSTERING ALGORITHMS ===\n"
"0","# Define clustering methods (following Akhanli & Hennig approach)"
"0","clustering_methods <- list("
"0","  "
"0","  # Partitioning methods"
"0","  pam = function(dist_matrix, k) {"
"0","    cluster::pam(dist_matrix, k, diss = TRUE, cluster.only = TRUE)"
"0","  },"
"0","  "
"0","  # Hierarchical methods  "
"0","  ward = function(dist_matrix, k) {"
"0","    hclust_result <- hclust(as.dist(dist_matrix), method = ""ward.D2"")"
"0","    cutree(hclust_result, k = k)"
"0","  },"
"0","  "
"0","  average_linkage = function(dist_matrix, k) {"
"0","    hclust_result <- hclust(as.dist(dist_matrix), method = ""average"") "
"0","    cutree(hclust_result, k = k)"
"0","  },"
"0","  "
"0","  complete_linkage = function(dist_matrix, k) {"
"0","    hclust_result <- hclust(as.dist(dist_matrix), method = ""complete"")"
"0","    cutree(hclust_result, k = k)"
"0","  },"
"0","  "
"0","  single_linkage = function(dist_matrix, k) {"
"0","    hclust_result <- hclust(as.dist(dist_matrix), method = ""single"")"
"0","    cutree(hclust_result, k = k)"
"0","  }"
"0",")"
"0",""
"0","# Function to perform clustering across methods and K values"
"0","perform_clustering_analysis <- function(distance_matrix, k_range, clustering_type = ""macro"") {"
"0","  "
"0","  cat(sprintf(""→ Performing %s clustering analysis (K = %d to %d)...\\n"", "
"0","              clustering_type, min(k_range), max(k_range)))"
"0","  "
"0","  results <- list()"
"0","  "
"0","  for (method_name in names(clustering_methods)) {"
"0","    cat(sprintf(""  → %s method...\\n"", method_name))"
"0","    "
"0","    method_results <- list()"
"0","    "
"0","    for (k in k_range) {"
"0","      tryCatch({"
"0","        "
"0","        # Perform clustering"
"0","        cluster_labels <- clustering_methods[[method_name]](distance_matrix, k)"
"0","        "
"0","        # Store results"
"0","        method_results[[paste0(""k_"", k)]] <- list("
"0","          k = k,"
"0","          labels = cluster_labels,"
"0","          method = method_name,"
"0","          n_clusters_actual = length(unique(cluster_labels))"
"0","        )"
"0","        "
"0","      }, error = function(e) {"
"0","        cat(sprintf(""    ✗ K=%d failed: %s\\n"", k, e$message))"
"0","        method_results[[paste0(""k_"", k)]] <- NULL"
"0","      })"
"0","    }"
"0","    "
"0","    results[[method_name]] <- method_results"
"0","    cat(sprintf(""  ✓ %s completed\\n"", method_name))"
"0","  }"
"0","  "
"0","  return(results)"
"0","}"
"0",""
"0","# Perform clustering for each distance method"
"0","all_clustering_results <- list()"
"0",""
"0","for (dist_method in names(distance_matrices)) {"
"0","  if (!is.null(distance_matrices[[dist_method]])) {"
"0","    "
"0","    cat(sprintf(""\\n--- Processing %s Distance Method ---\\n"", dist_method))"
"0","    "
"0","    dist_matrix <- distance_matrices[[dist_method]]$matrix"
"0","    "
"0","    # Macro-level clustering"
"0","    macro_results <- perform_clustering_analysis("
"0","      dist_matrix, "
"0","      CLUSTERING_PARAMS$macro$k_min:CLUSTERING_PARAMS$macro$k_max,"
"0","      ""macro"""
"0","    )"
"0","    "
"0","    # Micro-level clustering  "
"0","    micro_results <- perform_clustering_analysis("
"0","      dist_matrix,"
"0","      CLUSTERING_PARAMS$micro$k_min:CLUSTERING_PARAMS$micro$k_max, "
"0","      ""micro"""
"0","    )"
"0","    "
"0","    all_clustering_results[[dist_method]] <- list("
"0","      macro = macro_results,"
"0","      micro = micro_results,"
"0","      distance_info = distance_matrices[[dist_method]]"
"0","    )"
"0","  }"
"0","}"
"1","\n--- Processing unbiased_independent Distance Method ---\n"
"1","→ Performing macro clustering analysis (K = 3 to 8)...\n"
"1","  → pam method...\n"
"1","  ✓ pam completed\n"
"1","  → ward method...\n"
"1","  ✓ ward completed\n"
"1","  → average_linkage method...\n"
"1","  ✓ average_linkage completed\n"
"1","  → complete_linkage method...\n"
"1","  ✓ complete_linkage completed\n"
"1","  → single_linkage method...\n"
"1","  ✓ single_linkage completed\n"
"1","→ Performing micro clustering analysis (K = 10 to 25)...\n"
"1","  → pam method...\n"
"1","  ✓ pam completed\n"
"1","  → ward method...\n"
"1","  ✓ ward completed\n"
"1","  → average_linkage method...\n"
"1","  ✓ average_linkage completed\n"
"1","  → complete_linkage method...\n"
"1","  ✓ complete_linkage completed\n"
"1","  → single_linkage method...\n"
"1","  ✓ single_linkage completed\n"
"1","\n--- Processing unbiased_dependent Distance Method ---\n"
"1","→ Performing macro clustering analysis (K = 3 to 8)...\n"
"1","  → pam method...\n"
"1","  ✓ pam completed\n"
"1","  → ward method...\n"
"1","  ✓ ward completed\n"
"1","  → average_linkage method...\n"
"1","  ✓ average_linkage completed\n"
"1","  → complete_linkage method...\n"
"1","  ✓ complete_linkage completed\n"
"1","  → single_linkage method...\n"
"1","  ✓ single_linkage completed\n"
"1","→ Performing micro clustering analysis (K = 10 to 25)...\n"
"1","  → pam method...\n"
"1","  ✓ pam completed\n"
"1","  → ward method...\n"
"1","  ✓ ward completed\n"
"1","  → average_linkage method...\n"
"1","  ✓ average_linkage completed\n"
"1","  → complete_linkage method...\n"
"1","  ✓ complete_linkage completed\n"
"1","  → single_linkage method...\n"
"1","  ✓ single_linkage completed\n"
"0","cat(""\\n✓ Clustering analysis completed for all distance methods\\n"")"
"1","\n✓ Clustering analysis completed for all distance methods\n"
