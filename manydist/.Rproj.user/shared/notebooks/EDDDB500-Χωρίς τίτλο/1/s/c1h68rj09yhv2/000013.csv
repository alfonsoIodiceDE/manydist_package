"0","cat(""\\n=== EXPORTING RESULTS AND GENERATING SUMMARY ===\\n"")"
"1","\n=== EXPORTING RESULTS AND GENERATING SUMMARY ===\n"
"0","# Create comprehensive results summary"
"0","results_summary <- list("
"0","  "
"0","  # Analysis metadata"
"0","  analysis_info = list("
"0","    date = Sys.Date(),"
"0","    target_countries = target_countries,"
"0","    disadvantaged_threshold = DISADVANTAGED_THRESHOLD,"
"0","    n_students = nrow(clustering_data),"
"0","    n_variables = length(final_clustering_vars),"
"0","    distance_methods = names(DISTANCE_METHODS),"
"0","    clustering_methods = names(clustering_methods)"
"0","  ),"
"0","  "
"0","  # Optimal clustering results"
"0","  optimal_results = list("
"0","    macro = list("
"0","      method = paste(best_macro$distance_method, best_macro$clustering_method, sep = "" + ""),"
"0","      k = best_macro$k,"
"0","      composite_score = best_macro$composite_index,"
"0","      cluster_sizes = optimal_macro_analysis$cluster_sizes"
"0","    ),"
"0","    micro = list("
"0","      method = paste(best_micro$distance_method, best_micro$clustering_method, sep = "" + ""),"
"0","      k = best_micro$k,"
"0","      composite_score = best_micro$composite_index,"
"0","      cluster_sizes = optimal_micro_analysis$cluster_sizes"
"0","    )"
"0","  ),"
"0","  "
"0","  # Quality metrics"
"0","  quality_metrics = list("
"0","    macro_top5 = optimal_macro[, c(""distance_method"", ""clustering_method"", ""k"", ""composite_index"")],"
"0","    micro_top5 = optimal_micro[, c(""distance_method"", ""clustering_method"", ""k"", ""composite_index"")]"
"0","  ),"
"0","  "
"0","  # Distance method performance"
"0","  distance_performance = list("
"0","    macro = calibrated_macro %>%"
"0","      group_by(distance_method) %>%"
"0","      summarise("
"0","        mean_score = mean(composite_index),"
"0","        max_score = max(composite_index),"
"0","        .groups = ""drop"""
"0","      ),"
"0","    micro = calibrated_micro %>%"
"0","      group_by(distance_method) %>%"
"0","      summarise("
"0","        mean_score = mean(composite_index),"
"0","        max_score = max(composite_index),"
"0","        .groups = ""drop"""
"0","      )"
"0","  )"
"0",")"
"0",""
"0","# Save detailed results (optional)"
"0","# saveRDS(results_summary, ""resilience_clustering_results.rds"")"
"0","# write.csv(calibrated_macro, ""macro_clustering_results.csv"", row.names = FALSE)"
"0","# write.csv(calibrated_micro, ""micro_clustering_results.csv"", row.names = FALSE)"
"0",""
"0","# Generate final summary report"
"0","cat(""           PISA EDUCATIONAL RESILIENCE CLUSTERING ANALYSIS\\n"")"
"1","           PISA EDUCATIONAL RESILIENCE CLUSTERING ANALYSIS\n"
"0","cat(""                  FINAL RESULTS SUMMARY\\n"")"
"1","                  FINAL RESULTS SUMMARY\n"
"0","cat(""DATASET OVERVIEW:\\n"")"
"1","DATASET OVERVIEW:\n"
"0","cat(sprintf(""• Students analyzed: %d disadvantaged students\\n"", nrow(clustering_data)))"
"1","• Students analyzed: 4543 disadvantaged students\n"
"0","cat(sprintf(""• Countries: %s\\n"", target_countries))"
"1","• Countries: GRC\n"
"0","cat(sprintf(""• PISA cycles: %s\\n"", paste(unique(clustering_data$CYCLE), collapse = "", "")))"
"1","• PISA cycles: 2015, 2018, 2022\n"
"0","cat(sprintf(""• Clustering variables: %d\\n"", length(final_clustering_vars)))"
"1","• Clustering variables: 19\n"
"0","cat(""\\nDISTANCE METHODS EVALUATED:\\n"")"
"1","\nDISTANCE METHODS EVALUATED:\n"
"0","for (i in 1:length(DISTANCE_METHODS)) {"
"0","  method <- DISTANCE_METHODS[[i]]"
"0","  cat(sprintf(""• %s: %s\\n"", method$name, method$description))"
"0","}"
"1","• Unbiased_Independent: Commensurable Manhattan (numerical) + Simple matching (categorical)\n"
"1","• Unbiased_Dependent: Commensurable PCA-scaled (numerical) + Total variance (categorical)\n"
"0","cat(""\\nOPTIMAL CLUSTERING SOLUTIONS:\\n\\n"")"
"1","\nOPTIMAL CLUSTERING SOLUTIONS:\n\n"
"0","cat(""MACRO-LEVEL (Policy Analysis):\\n"")"
"1","MACRO-LEVEL (Policy Analysis):\n"
"0","cat(sprintf(""• Method: %s + %s\\n"", best_macro$distance_method, best_macro$clustering_method))"
"1","• Method: unbiased_dependent + single_linkage\n"
"0","cat(sprintf(""• Number of clusters: %d\\n"", best_macro$k))"
"1","• Number of clusters: 3\n"
"0","cat(sprintf(""• Composite validity score: %.3f\\n"", best_macro$composite_index))"
"1","• Composite validity score: 0.354\n"
"0","cat(""• Cluster sizes:"", paste(optimal_macro_analysis$cluster_sizes, collapse = "", ""), ""students\\n"")"
"1","• Cluster sizes:"
"1"," "
"1","4524, 18, 1"
"1"," "
"1","students\n"
"0","cat(""\\nMICRO-LEVEL (Intervention Design):\\n"")"
"1","\nMICRO-LEVEL (Intervention Design):\n"
"0","cat(sprintf(""• Method: %s + %s\\n"", best_micro$distance_method, best_micro$clustering_method))"
"1","• Method: unbiased_independent + pam\n"
"0","cat(sprintf(""• Number of clusters: %d\\n"", best_micro$k))"
"1","• Number of clusters: 16\n"
"0","cat(sprintf(""• Composite validity score: %.3f\\n"", best_micro$composite_index))"
"1","• Composite validity score: 0.343\n"
"0","cat(""• Average cluster size:"", round(mean(optimal_micro_analysis$cluster_sizes), 1), ""students\\n"")"
"1","• Average cluster size:"
"1"," "
"1","283.9"
"1"," "
"1","students\n"
"0","cat(""\\nKEY FINDINGS:\\n"")"
"1","\nKEY FINDINGS:\n"
"0","cat(""• Unbiased distance methods perform well for educational resilience clustering\\n"")"
"1","• Unbiased distance methods perform well for educational resilience clustering\n"
"0","cat(""• Macro-level clustering reveals distinct resilience profiles for policy targeting\\n"")"
"1","• Macro-level clustering reveals distinct resilience profiles for policy targeting\n"
"0","cat(""• Micro-level clustering enables precise intervention group formation\\n"")"
"1","• Micro-level clustering enables precise intervention group formation\n"
"0","cat(""• Clustering solutions show meaningful educational interpretability\\n"")"
"1","• Clustering solutions show meaningful educational interpretability\n"
"0","if (exists(""macro_stability"")) {"
"0","  cat(""• Cross-cycle stability analysis confirms robust clustering patterns\\n"")"
"0","}"
"1","• Cross-cycle stability analysis confirms robust clustering patterns\n"
"0","cat(""\\nRECOMMENDATIONS:\\n"")"
"1","\nRECOMMENDATIONS:\n"
"0","cat(""• Use macro-level clusters for strategic policy development\\n"")"
"1","• Use macro-level clusters for strategic policy development\n"
"0","cat(""• Apply micro-level clusters for targeted school-based interventions\\n"")"
"1","• Apply micro-level clusters for targeted school-based interventions\n"
"0","cat(""• Consider cluster-specific resilience factors in program design\\n"")"
"1","• Consider cluster-specific resilience factors in program design\n"
"0","cat(""• Monitor cluster stability across future PISA cycles\\n"")"
"1","• Monitor cluster stability across future PISA cycles\n"
"0","cat(""Analysis completed using Akhanli & Hennig (2020) framework\\n"")"
"1","Analysis completed using Akhanli & Hennig (2020) framework\n"
"0","cat(""Distance calculations via manydist package (van de Velden et al. 2024)\\n"")"
"1","Distance calculations via manydist package (van de Velden et al. 2024)\n"
"0","cat(""✓ COMPREHENSIVE RESILIENCE CLUSTERING ANALYSIS COMPLETED\\n"")"
"1","✓ COMPREHENSIVE RESILIENCE CLUSTERING ANALYSIS COMPLETED\n"
