"0","cat(""\\n=== SELECTING OPTIMAL CLUSTERINGS ===\\n"")"
"1","\n=== SELECTING OPTIMAL CLUSTERINGS ===\n"
"0","# Find best clusterings for macro and micro levels"
"0","find_optimal_clusterings <- function(calibrated_df, top_n = 5) {"
"0","  "
"0","  # Sort by composite index (descending)"
"0","  optimal_df <- calibrated_df[order(calibrated_df$composite_index, decreasing = TRUE), ]"
"0","  "
"0","  # Get top N results"
"0","  top_results <- head(optimal_df, top_n)"
"0","  "
"0","  return(top_results)"
"0","}"
"0",""
"0","# Macro-level optimal clusterings"
"0","optimal_macro <- find_optimal_clusterings(calibrated_macro, 5)"
"0","cat(""\\n--- TOP 5 MACRO-LEVEL CLUSTERINGS ---\\n"")"
"1","\n--- TOP 5 MACRO-LEVEL CLUSTERINGS ---\n"
"0","print(optimal_macro[, c(""distance_method"", ""clustering_method"", ""k"", "
"0","                        ""within_dissim"", ""separation"", ""entropy"", "
"0","                        ""pearson_gamma"", ""composite_index"")])"
